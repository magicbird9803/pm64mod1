%World item usage script
%Gets dmaed at 802C05CC / 32579C

/%
0000004D 00000001 00000000 
00000043 00000002 802D0E28 00000001 
00000043 00000002 802D2B0C FE363C80 
0000000B 00000002 FE363C80 00000000 
	00000043 00000001 802D2B6C 
	00000008 00000001 00000014 
00000013 00000000 
00000043 00000001 802C02E4 
00000043 00000002 802C0358 FE363C8A 
00000046 00000001 802C0410 
0000000A 00000002 FE363C8D 00000000 
	00000046 00000001 802C04F4
00000012 00000000 
	00000046 00000001 802C0560 
00000013 00000000 
0000000A 00000002 FE363C8F 00000001 
	00000043 00000002 802D1084 0001001D 
00000013 00000000 
0000000D 00000002 FE363C8B 00000000 
	00000043 00000004 802D1DFC FE363C80 FE363C81 FE363C82 
	00000027 00000002 FE363C80 00000000 
	00000027 00000002 FE363C81 00000023 
	00000043 00000005 802C00AC FE363C80 FE363C81 FE363C82 FE363C8B 
00000013 00000000
0000000D 00000002 FE363C8C 00000000
	00000043 00000004 802D1DFC FE363C80 FE363C81 FE363C82 
	00000027 00000002 FE363C80 00000014 
	00000027 00000002 FE363C81 00000019 
	00000043 00000005 802C016C FE363C80 FE363C81 FE363C82 FE363C8C 
00000013 00000000 
00000043 00000004 802D1DFC FE363C80 FE363C81 FE363C82 
00000027 00000002 FE363C81 00000019 
00000043 00000005 802D7520 FE363C80 FE363C81 FE363C82 FE363C8B
0000000B 00000002 FE363C8B 00000000
	00000043 00000002 802C022C FE363C8B
00000013 00000000 
0000000B 00000002 FE363C8C 00000000 
	00000043 00000002 802C0288 FE363C8C 
00000013 00000000
0000000A 00000002 FE363C8F 00000000
	00000008 00000001 0000000A 
	00000043 00000002 802D1084 00010032 
	00000008 00000001 0000001E 
00000012 00000000
	00000008 00000001 0000001E 
00000013 00000000 
00000043 00000004 802D1DFC FE363C80 FE363C81 FE363C82 
00000043 00000005 802D75D8 FE363C80 FE363C81 FE363C82 FE363C8B 
00000043 00000002 802D1084 00010002 
00000008 00000001 00000014 
00000043 00000001 802C03E8
00000043 00000002 802D0E28 00000000
00000043 00000001 802C031C 
00000002 00000000 
00000001 00000000
%/

@Data 32579C
{
	00000046 00000001 $NewGlobalItemScript
	00000002 00000000
	00000001 00000000
}

%Map script?
%Var A is set very early on, maybe even before the first script command?
#new:Script:Map $NewGlobalItemScript
{
		Call 	$Function_SetArbitraryByte  ( 00000000 $IsRemovalItem )
    0:  SetGroup  00000000 
    C:  Call  DisablePlayerInput    ( .True )
   1C:  Call  GetCurrentPartner     ( *Var[0] )
   2C:  If  *Var[0]  !=  00000000 
   3C:  	Call  802D2B6C ( )						%sets 4 flag on 8010EFC8
   48:  	Wait  20`
   54:  EndIf
   5C:  Call  802C02E4 ( )
   68:  Call  802C0358  ( *Var[A] )			%get item as varA? (Also sets varB and varC to HP and FP heal) (sets VarD too as eat/drink boolean?)		(when is VarF set? looks like a "negative heal" thing)
		Set *Var9 *VarA
   78:  ExecWait  802C0410 					%item anim
		Set *VarA *Var9
		Switch *VarA
			Case == .Item:DarkTea				
				If  *Var[D]  ==  00000000 
					ExecWait  802C04F4 				%eat anim and sounds
				Else
					ExecWait  802C0560 				%drink anim and sounds
				EndIf								%post animations
				If  *Var[F]  ==  00000001 
					Call  SetPlayerAnimation    ( .PlayerAnim:StickOutTongue )
				EndIf
				Call     $Function_HPHeal ( -50` )
				If  *Var[F]  ==  00000000 
					Wait  10`
					Call  SetPlayerAnimation    ( .PlayerAnim:ThumbsUp )
					Wait  30`
				Else
					Wait  30`
				EndIf
				Call  SetPlayerAnimation    ( 00010002 )
				Wait  20`
				Call  802C03E8 ( )
				Call  DisablePlayerInput    ( .False )
				Call  802C031C ( )
				Return				
			Case == .Item:DarkShroomCake
				If  *Var[D]  ==  00000000 
					ExecWait  802C04F4 				%eat anim and sounds
				Else
					ExecWait  802C0560 				%drink anim and sounds
				EndIf								%post animations
				If  *Var[F]  ==  00000001 
					Call  SetPlayerAnimation    ( .PlayerAnim:StickOutTongue )
				EndIf
				Call     $Function_HPHeal ( -15` )
				Call     $Function_FPHeal ( -15` )
				If  *Var[F]  ==  00000000 
					Wait  10`
					Call  SetPlayerAnimation    ( .PlayerAnim:ThumbsUp )
					Wait  30`
				Else
					Wait  30`
				EndIf
				Call  SetPlayerAnimation    ( 00010002 )
				Wait  20`
				Call  802C03E8 ( )
				Call  DisablePlayerInput    ( .False )
				Call  802C031C ( )
				Return							
			Case == .Item:DarkPop
				If  *Var[D]  ==  00000000 
					ExecWait  802C04F4 				%eat anim and sounds
				Else
					ExecWait  802C0560 				%drink anim and sounds
				EndIf								%post animations
				If  *Var[F]  ==  00000001 
					Call  SetPlayerAnimation    ( .PlayerAnim:StickOutTongue )
				EndIf
				Call 	$Function_GetPlayerDataByte ( *VarB 5` )
				Div *VarB 2`
				Mul *VarB -1`
				Call 	$Function_FPHeal ( *VarB )
				If  *Var[F]  ==  00000000 
					Wait  10`
					Call  SetPlayerAnimation    ( .PlayerAnim:ThumbsUp )
					Wait  30`
				Else
					Wait  30`
				EndIf
				Call  SetPlayerAnimation    ( 00010002 )
				Wait  20`
				Call  802C03E8 ( )
				Call  DisablePlayerInput    ( .False )
				Call  802C031C ( )
				Return							
			Case == .Item:GoldenShroomCake
				Label 	30
				Call 	RemoveItem ( .Item:GoldenShroomCake *Var1 )
				If *Var1 != FFFFFFFF
					Call 	$Function_SetArbitraryByte  ( 00000001 $IsRemovalItem )
					Goto 30
				EndIf				
			Case == .Item:GoldenMeal
				Label 	31
				Call 	RemoveItem ( .Item:GoldenMeal *Var1 )
				If *Var1 != FFFFFFFF
					Call 	$Function_SetArbitraryByte  ( 00000001 $IsRemovalItem )
					Goto 31
				EndIf
			Case == .Item:MiracleGolden
				Label 	32
				Call 	RemoveItem ( .Item:MiracleGolden *Var1 )
				If *Var1 != FFFFFFFF
					Call 	$Function_SetArbitraryByte  ( 00000001 $IsRemovalItem )
					Goto 32
				EndIf				
			Case == .Item:MiracleJelly
				Label 	33
				Call 	RemoveItem ( .Item:MiracleJelly *Var1 )
				If *Var1 != FFFFFFFF
					Call 	$Function_SetArbitraryByte  ( 00000001 $IsRemovalItem )
					Goto 33
				EndIf				
			Case == .Item:StrangeTea
				If  *Var[D]  ==  00000000 
					ExecWait  802C04F4 				%eat anim and sounds
				Else
					ExecWait  802C0560 				%drink anim and sounds
				EndIf								%post animations
				If  *Var[F]  ==  00000001 
					Call  SetPlayerAnimation    ( .PlayerAnim:StickOutTongue )
				EndIf
				Call 	$Function_GetPlayerDataByte ( *VarB 2` )
				Mod 	*VarB 2`
				If *VarB == 0`
					Call 	$Function_GetPlayerDataByte ( *VarC 2` )
					Div *VarC 2`
					Call 	$Function_SetArbitraryByte  ( *VarC 8010F292 )
				Else
					Call 	$Function_GetPlayerDataByte ( *VarC 2` )
					Mul *VarC 2`
					Call 	$Function_GetPlayerDataByte ( *VarD 3` )
					If *VarC > *VarD
						Set *VarC *VarD
					EndIf
					Call 	$Function_SetArbitraryByte  ( *VarC 8010F292 )
				EndIf
				Call 	$Function_GetPlayerDataByte ( *VarB 5` )
				Mod 	*VarB 2`
				If *VarB == 0`
					Call 	$Function_GetPlayerDataByte ( *VarC 5` )
					Div *VarC 2`
					Call 	$Function_SetArbitraryByte  ( *VarC 8010F295 )
				Else
					Call 	$Function_GetPlayerDataByte ( *VarC 5` )
					Mul *VarC 2`
					Call 	$Function_GetPlayerDataByte ( *VarD 6` )
					If *VarC > *VarD
						Set *VarC *VarD
					EndIf
					Call 	$Function_SetArbitraryByte  ( *VarC 8010F295 )
				EndIf
				If  *Var[F]  ==  00000000 
					Wait  10`
					Call  SetPlayerAnimation    ( .PlayerAnim:ThumbsUp )
					Wait  30`
				Else
					Wait  30`
				EndIf
				Call  SetPlayerAnimation    ( 00010002 )
				Wait  20`
				Call  802C03E8 ( )
				Call  DisablePlayerInput    ( .False )
				Call  802C031C ( )
				Return				
			Case == .Item:BakingCream
				Call 	$Function_GetPlayerDataByte ( *VarB 2` )
				Call 	$Function_GetPlayerDataByte ( *VarC 5` )
			Case == .Item:KookyCookie
				Call 	$Function_GetPlayerDataByte ( *VarB 5` )
				Call 	$Function_GetPlayerDataByte ( *VarC 2` )
			Case == .Item:StrangeCake
				If  *Var[D]  ==  00000000 
					ExecWait  802C04F4 				%eat anim and sounds
				Else
					ExecWait  802C0560 				%drink anim and sounds
				EndIf								%post animations
				If  *Var[F]  ==  00000001 
					Call  SetPlayerAnimation    ( .PlayerAnim:StickOutTongue )
				EndIf
				Call 	$Function_GetPlayerDataByte ( *VarB 5` )	%fp
				Call 	$Function_GetPlayerDataByte ( *VarC 3` )	%mHP
				If *VarB > *VarC
					Set *VarB *VarC
				EndIf
				If *VarB < 1`
					Set *VarB 1`
				EndIf
				Call 	$Function_SetArbitraryByte  ( *VarB 8010F292 )
				%
				Call 	$Function_GetPlayerDataByte ( *VarC 2` )	%hp
				Call 	$Function_GetPlayerDataByte ( *VarB 6` )	%mfp
				If *VarC > *VarB
					Set *VarC *VarB
				EndIf
				Call 	$Function_SetArbitraryByte  ( *VarC 8010F295 )
				If  *Var[F]  ==  00000000 
					Wait  10`
					Call  SetPlayerAnimation    ( .PlayerAnim:ThumbsUp )
					Wait  30`
				Else
					Wait  30`
				EndIf
				Call  SetPlayerAnimation    ( 00010002 )
				Wait  20`
				Call  802C03E8 ( )
				Call  DisablePlayerInput    ( .False )
				Call  802C031C ( )
				Return
			Case == .Item:StrangeLeaf
				If  *Var[D]  ==  00000000 
					ExecWait  802C04F4 				%eat anim and sounds
				Else
					ExecWait  802C0560 				%drink anim and sounds
				EndIf								%post animations
				If  *Var[F]  ==  00000001 
					Call  SetPlayerAnimation    ( .PlayerAnim:StickOutTongue )
				EndIf
				Call	 $Function_GetPlayerDataByte ( *VarF 2` )					
				Call	 $Function_GetPlayerDataByte ( *VarE 3` )
				Sub 	 *VarE *VarF
				If *VarE < 1`
					Set *VarE 1`
				EndIf
				Call	 $Function_SetArbitraryByte  ( *VarE 8010F292 )
				%
				Call	 $Function_GetPlayerDataByte ( *VarF 5` )					
				Call	 $Function_GetPlayerDataByte ( *VarE 6` )
				Sub 	 *VarE *VarF
				Call	 $Function_SetArbitraryByte  ( *VarE 8010F295 )
				If  *Var[F]  ==  00000000 
					Wait  10`
					Call  SetPlayerAnimation    ( .PlayerAnim:ThumbsUp )
					Wait  30`
				Else
					Wait  30`
				EndIf
				Call  SetPlayerAnimation    ( 00010002 )
				Wait  20`
				Call  802C03E8 ( )
				Call  DisablePlayerInput    ( .False )
				Call  802C031C ( )
				Return
			Case == .Item:StinkyHerb
				If  *Var[D]  ==  00000000 
					ExecWait  802C04F4 				%eat anim and sounds
				Else
					ExecWait  802C0560 				%drink anim and sounds
				EndIf								%post animations
				If  *Var[F]  ==  00000001 
					Call  SetPlayerAnimation    ( .PlayerAnim:StickOutTongue )
				EndIf
				Call	 $Function_GetPlayerDataByte ( *VarF 2` )					
				Call	 $Function_GetPlayerDataByte ( *VarE 3` )
				Add 	 *VarE *VarF
				Div 	 *VarE 2`
				Call	 $Function_SetArbitraryByte  ( *VarE 8010F292 )
				%
				Call	 $Function_GetPlayerDataByte ( *VarF 5` )					
				Call	 $Function_GetPlayerDataByte ( *VarE 6` )
				Add 	 *VarE *VarF
				Div 	 *VarE 2`
				Call	 $Function_SetArbitraryByte  ( *VarE 8010F295 )
				If  *Var[F]  ==  00000000 
					Wait  10`
					Call  SetPlayerAnimation    ( .PlayerAnim:ThumbsUp )
					Wait  30`
				Else
					Wait  30`
				EndIf
				Call  SetPlayerAnimation    ( 00010002 )
				Wait  20`
				Call  802C03E8 ( )
				Call  DisablePlayerInput    ( .False )
				Call  802C031C ( )
				Return
			Case == .Item:StarCake
				If  *Var[D]  ==  00000000 
					ExecWait  802C04F4 				%eat anim and sounds
				Else
					ExecWait  802C0560 				%drink anim and sounds
				EndIf								%post animations
				If  *Var[F]  ==  00000001 
					Call  SetPlayerAnimation    ( .PlayerAnim:StickOutTongue )
				EndIf
				Call 	$Function_AddSP ( 00000400 )
				If  *Var[F]  ==  00000000 
					Wait  10`
					Call  SetPlayerAnimation    ( .PlayerAnim:ThumbsUp )
					Wait  30`
				Else
					Wait  30`
				EndIf
				Call  SetPlayerAnimation    ( 00010002 )
				Wait  20`
				Call  802C03E8 ( )
				Call  DisablePlayerInput    ( .False )
				Call  802C031C ( )
				Return
			Case == .Item:DarkCake
				If  *Var[D]  ==  00000000 
					ExecWait  802C04F4 				%eat anim and sounds
				Else
					ExecWait  802C0560 				%drink anim and sounds
				EndIf								%post animations
				If  *Var[F]  ==  00000001 
					Call  SetPlayerAnimation    ( .PlayerAnim:StickOutTongue )
				EndIf
				Call 	$Function_AddSP ( FFFFF900 )
				If  *Var[F]  ==  00000000 
					Wait  10`
					Call  SetPlayerAnimation    ( .PlayerAnim:ThumbsUp )
					Wait  30`
				Else
					Wait  30`
				EndIf
				Call  SetPlayerAnimation    ( 00010002 )
				Wait  20`
				Call  802C03E8 ( )
				Call  DisablePlayerInput    ( .False )
				Call  802C031C ( )
				Return
		EndSwitch
   84:  If  *Var[D]  ==  00000000 
   94:  	ExecWait  802C04F4 				%eat anim and sounds
   A0:  Else
   A8:  	ExecWait  802C0560 				%drink anim and sounds
   B4:  EndIf								%post animations
   BC:  If  *Var[F]  ==  00000001 
   CC:  	Call  SetPlayerAnimation    ( .PlayerAnim:StickOutTongue )
   DC:  EndIf
   E4:  If  *Var[B]  >  00000000 
   F4:  	Call  GetPlayerPos  ( *Var[0] *Var[1] *Var[2] )
  10C:  	Add   *Var[0]  00000000 
  11C:  	Add   *Var[1]  00000023 
  12C:  	Call  802C00AC      ( *Var[0] *Var[1] *Var[2] *Var[B] )
  148:  EndIf
  150:  If  *Var[C]  >  00000000 
  160:  	Call  GetPlayerPos  ( *Var[0] *Var[1] *Var[2] )
  178:  	Add   *Var[0]  00000014 
  188:  	Add   *Var[1]  00000019 
  198:  	Call  802C016C      ( *Var[0] *Var[1] *Var[2] *Var[C] )
  1B4:  EndIf
  1BC:  Call  GetPlayerPos  ( *Var[0] *Var[1] *Var[2] )
  1D4:  Add   *Var[1]  00000019 
  1E4:  Call  802D7520      ( *Var[0] *Var[1] *Var[2] *Var[B] )
  200:  If  *Var[B]  !=  00000000 
  210:  	Call  802C022C  ( *Var[B] )			%HP heal
  220:  EndIf
  228:  If  *Var[C]  !=  00000000 
  238:  	Call  802C0288  ( *Var[C] )			%FP heal
  248:  EndIf
		Call  $Function_EnforceFPLimit ( )
  250:  If  *Var[F]  ==  00000000 
  260:  	Wait  10`
  26C:  	Call  SetPlayerAnimation    ( .PlayerAnim:ThumbsUp )
  27C:  	Wait  30`
  288:  Else
  290:  	Wait  30`
  29C:  EndIf
  2A4:  Call  GetPlayerPos  ( *Var[0] *Var[1] *Var[2] )
  2BC:  Call  802D75D8  ( *Var[0] *Var[1] *Var[2] *Var[B] )
  2D8:  Call  SetPlayerAnimation    ( 00010002 )
  2E8:  Wait  20`
  2F4:  Call  802C03E8 ( )
  300:  Call  DisablePlayerInput    ( .False )
  310:  Call  802C031C ( )
	Return
	End
}

#export:Data $IsRemovalItem
{
	00000000
}

#new:Function $Function_EnforceFPLimit
{
	LI		A0, 8010F290
	LB		A1, 5 (A0)
	LB		A2, 6 (A0)	
	BLT		A1, A2, .end
	NOP
	COPY	A1, A2
	SAB		A2, 8010F295
	.end
	JR		RA
	NOP
}

/%
Script: 802C05CC (0032579C)

    0:  SetGroup  00000000 
    C:  Call  DisablePlayerInput    ( .True )
   1C:  Call  GetCurrentPartner     ( *Var[0] )
   2C:  If  *Var[0]  !=  00000000 
   3C:  	Call  802D2B6C ( )						%sets 4 flag on 8010EFC8
   48:  	Wait  20`
   54:  EndIf
   5C:  Call  802C02E4 ( )
   68:  Call  802C0358  ( *Var[A] )			%get item as varA? (Also sets varB and varC to HP and FP heal)
   78:  ExecWait  802C0410 					%item anim
   84:  If  *Var[D]  ==  00000000 
   94:  	ExecWait  802C04F4 				%eat anim and sounds
   A0:  Else
   A8:  	ExecWait  802C0560 				%drink anim and sounds
   B4:  EndIf								%post animations
   BC:  If  *Var[F]  ==  00000001 
   CC:  	Call  SetPlayerAnimation    ( .PlayerAnim:StickOutTongue )
   DC:  EndIf
   E4:  If  *Var[B]  >  00000000 
   F4:  	Call  GetPlayerPos  ( *Var[0] *Var[1] *Var[2] )
  10C:  	Add   *Var[0]  00000000 
  11C:  	Add   *Var[1]  00000023 
  12C:  	Call  802C00AC      ( *Var[0] *Var[1] *Var[2] *Var[B] )
  148:  EndIf
  150:  If  *Var[C]  >  00000000 
  160:  	Call  GetPlayerPos  ( *Var[0] *Var[1] *Var[2] )
  178:  	Add   *Var[0]  00000014 
  188:  	Add   *Var[1]  00000019 
  198:  	Call  802C016C      ( *Var[0] *Var[1] *Var[2] *Var[C] )
  1B4:  EndIf
  1BC:  Call  GetPlayerPos  ( *Var[0] *Var[1] *Var[2] )
  1D4:  Add   *Var[1]  00000019 
  1E4:  Call  802D7520      ( *Var[0] *Var[1] *Var[2] *Var[B] )
  200:  If  *Var[B]  !=  00000000 
  210:  	Call  802C022C  ( *Var[B] )			%HP heal
  220:  EndIf
  228:  If  *Var[C]  !=  00000000 
  238:  	Call  802C0288  ( *Var[C] )			%FP heal
  248:  EndIf
  250:  If  *Var[F]  ==  00000000 
  260:  	Wait  10`
  26C:  	Call  SetPlayerAnimation    ( .PlayerAnim:ThumbsUp )
  27C:  	Wait  30`
  288:  Else
  290:  	Wait  30`
  29C:  EndIf
  2A4:  Call  GetPlayerPos  ( *Var[0] *Var[1] *Var[2] )
  2BC:  Call  802D75D8  ( *Var[0] *Var[1] *Var[2] *Var[B] )
  2D8:  Call  SetPlayerAnimation    ( 00010002 )
  2E8:  Wait  20`
  2F4:  Call  802C03E8 ( )
  300:  Call  DisablePlayerInput    ( .False )
  310:  Call  802C031C ( )
  31C:  Return
  324:  End


Script: 802C0410 (003255E0)

    0:  SetGroup  00000000 
    C:  Call  SetPlayerAnimation    ( .PlayerAnim:GotItem )
   1C:  Call  GetPlayerPos      ( *Var[0] *Var[1] *Var[2] )
   34:  Add   *Var[1]  0000002D 
   44:  Call  MakeItemEntity    ( *Var[A] *Var[0] *Var[1] *Var[2] .ItemSpawnMode:Decoration 00000000 )
   68:  Set   *Var[A]  *Var[0] 
   78:  Wait  15`
   84:  Call  GetPlayerPos      ( *Var[0] *Var[1] *Var[2] )
   9C:  Add   *Var[1]  00000014 
   AC:  Call  802C0000  ( *Var[0] *Var[1] *Var[2] )
   C4:  Call  RemoveItemEntity  ( *Var[A] )
   D4:  Return
   DC:  End
%/



%Function 802C03E8
%	Removes the item (Removal happens after the script executes!) (3255B8)


@Hook 3255B8
{
	PUSH	A0, A1, A2
	LAW		A0, 8010CD20		%number of bytes after 8010F444
	LI		A1, 8010F444
	ADD		A0, A0, A1
	LB		A2, 0 (A0)
	SAW		R0, $ReplaceItem
	%Copy removal items (skip normal removal code)
	LAW		A0, $IsRemovalItem
	BNE		A0, R0, .skipremove
	NOP
	%
	LI		A1, .Item:DualShroom
	BNE		A1, A2, .nodual
	NOP
	LI		A0, .Item:HalfShroom
	SAW		A0, $ReplaceItem
	BEQ		R0, R0, .end
	NOP
	.nodual
	LI		A1, .Item:DualShroomCake
	BNE		A1, A2, .nodualcake
	NOP
	LI		A0, .Item:HalfShroomCake
	SAW		A0, $ReplaceItem
	BEQ		R0, R0, .end
	NOP
	.nodualcake	
	LI		A1, .Item:SuperBunch
	BNE		A1, A2, .nosuperbunch
	NOP
	LI		A0, .Item:SuperShroom
	SAW		A0, $ReplaceItem
	BEQ		R0, R0, .end
	NOP
	.nosuperbunch
	LI		A1, .Item:ShroomBunch
	BNE		A1, A2, .noshroombunch
	NOP
	LI		A0, .Item:Mushroom
	SAW		A0, $ReplaceItem
	BEQ		R0, R0, .end
	NOP
	.noshroombunch	
	LI		A1, .Item:ShroomTrio
	BNE		A1, A2, .noshroomtrio
	NOP
	LI		A0, .Item:ShroomBunch
	SAW		A0, $ReplaceItem
	BEQ		R0, R0, .end
	NOP
	.noshroomtrio
	LI		A1, .Item:SuperTrio
	BNE		A1, A2, .nosupertrio
	NOP
	LI		A0, .Item:SuperBunch
	SAW		A0, $ReplaceItem
	BEQ		R0, R0, .end
	NOP
	.nosupertrio
	LI		A1, .Item:DualJelly
	BNE		A1, A2, .end
	NOP
	LI		A0, .Item:HalfJelly
	SAW		A0, $ReplaceItem	
	.end
	POP		A0, A1, A2
	ADDI	SP, SP, -18
	J		802C03F0
	SW		RA, 10 (SP)
	.skipremove
	POP		A0, A1, A2
	ADDI	SP, SP, -18
	J		802C03F8
	SW		RA, 10 (SP)	
}

#new:Data $ReplaceItem
{
	00000000
}

@Hook 3255D0
{
	PUSH	A0, A1, A2
	LAW		A0, $ReplaceItem
	BEQ		A0, R0, .nostore
	NOP
	%storing at 8010F444 is always safe because there must be at least 1 open slot since 1 item was removed
	SAB		A0, 8010F444
	.nostore
	POP		A0, A1, A2	
	ADDI	SP, SP, 18
	JR		RA				%overwrote a JR RA so no need for normal jump
	NOP
}

%Fully dmaed starting...
%3251D0
